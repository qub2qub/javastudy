http://www.sql-tutorial.ru/ru/book_having_clause.html
 Предложение HAVING
Если предложение WHERE определяет предикат для фильтрации строк, то предложение HAVING применяется после группировки для определения аналогичного предиката, фильтрующего группы по значениям агрегатных функций. Это предложение необходимо для проверки значений, которые получены с помощью агрегатной функции не из отдельных строк источника записей, определенного в предложении FROM, а из групп таких строк. Поэтому такая проверка не может содержаться в предложении WHERE.

Пример 5.5.5

Получить количество ПК и среднюю цену для каждой модели, средняя цена которой менее $800

Консоль
Выполнить Скопировать Ctrl-C

    SELECT model, COUNT(model) AS Qty_model,
       AVG(price) AS Avg_price
    FROM PC
    GROUP BY model
    HAVING AVG(price) < 800;


В результате выполнения запроса получим:

1232 	4 	425
1260 	1 	350

Заметим, что в предложении HAVING нельзя использовать псевдоним (Avg_price), используемый для именования значений агрегатной функции в предложении SELECT. Дело в том, что предложение SELECT, формирующее выходной набор запроса, выполняется предпоследним перед предложением ORDER BY. Ниже приведен порядок обработки предложений в операторе SELECT:

    FROM
    WHERE
    GROUP BY
    HAVING
    SELECT
    ORDER BY

Этот порядок не соответствует синтаксическому порядку общего представления оператора SELECT, который ближе к естественному языку:

    SELECT [DISTINCT | ALL]{*
     | [<выражение для столбца> [[AS] <псевдоним>]] [,…]}
    FROM <имя таблицы> [[AS] <псевдоним>] [,…]
    [WHERE <предикат>]
    [[GROUP BY <список столбцов>]
    [HAVING <условие на агрегатные значения>] ]
    [ORDER BY <список столбцов>]

Следует отметить, что предложение HAVING может использоваться и без предложения GROUP BY. При отсутствии предложения GROUP BY агрегатные функции применяются ко всему выходному набору строк запроса, т.е. в результате мы получим всего одну строку, если выходной набор не пуст.

Таким образом, если условие на агрегатные значения в предложение HAVING будет истинным, то эта строка будет выводиться, в противном случае мы не получим ни одной строки. Рассмотрим такой пример.

Пример 5.5.6

Найти максимальную, минимальную и среднюю цену на персональные компьютеры.

Решение этой задачи дает следующий запрос:

Консоль
Выполнить Скопировать Ctrl-C

    SELECT MIN(price) AS min_price,
    MAX(price) AS max_price, AVG(price) avg_price
    FROM PC;

результатам которого будет

350.00 	980.00 	675.00

Если же мы добавим в условие ограничение, скажем, на среднюю цену:

Найти максимальную, минимальную и среднюю цену на персональные компьютеры при условии, что средняя цена не превышает $600:

Консоль
Выполнить Скопировать Ctrl-C

    SELECT MIN(price) AS min_price,
    MAX(price) AS max_price, AVG(price) avg_price
    FROM PC
    HAVING AVG(price) <= 600;

то в результате получим пустой результирующий набор, т.к. 675.00 > 600.